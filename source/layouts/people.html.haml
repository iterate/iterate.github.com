!!!
%html
  %head
    %meta{charset: "utf-8"}
    %meta{content: "IE=edge,chrome=1", http: {equiv: "X-UA-Compatible"}}
    %meta{name: "viewport", content: "width=device-width, initial-scale=1"}
    %meta{name: "description", content: "Iterate jobber med selskaper i digital endring. Vi programmerer, rådgir, leder og designer sammen med våre kunder."}  

    %meta{:property => "og:title", :content => current_page.data.title + "| Iterate"}
    %meta{:property => "og:site_name", :content => "Iterates hjemmeside"}
    - if current_page.metadata[:page].try(:[], 'open_graph_image')
      %meta{:property => "og:image", :content => "#{current_page.metadata[:page]['open_graph_image']}"}
    -else
      %meta{:property => "og:image", :content => image_path('fb_opengraph.jpg')}


    %title= current_page.data.title "| Iterate"
    = stylesheet_link_tag "application"
    = stylesheet_link_tag "https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"

  %body{class: page_classes}
    %nav#navigation-bar
      = partial 'partials/navigation'

    = yield
    %footer
      = partial 'partials/footer'
    = javascript_include_tag "https://code.jquery.com/jquery-2.1.1.min.js", "application"
    :javascript
      $(function() {
      var winHeight = $(window).height();
      var itemHeight = 236; // mugshot+margin
      var minHeight = 500; // TODO: in case of small viewport, size of largest content.
      $('.gridder').gridderExpander({
          scroll: true,
          scrollOffset: 100,
          scrollTo: "panel",                  // panel or listitem
          animationSpeed: 400,
          animationEasing: "easeInOutExpo",
          showNav: false,                      // Show Navigation
          onStart: function(){
            //Gridder Inititialized
          },
          onContent: function($expand){
            var h = winHeight - (itemHeight - 150);
            if (h < minHeight) h = minHeight;
            $($expand).height(h);
          },
          onClosed: function(){
            //Gridder Closed
          }
      });

      // Initial routing
      var deeplink = window.location.hash;
      if (deeplink) {
        var $el = document.querySelector(deeplink);
        if ($el) $el.click();
      }

      });
      $.get("https://blogfeed.app.iterate.no/").then(function (data) {
          var articles = data.slice(0,3);
          articles.reverse();
          articles.forEach(function(e) {
            $('.blog-list').prepend($("<li><a href=\""+e.Link+"\">"+e.Title+"</a><br><span class=\"blog-post-date\">"+new Date(e.PubDate).toDateString()+"</span></li>"));
          });
          }).fail(function() { console.log("Something went wrong when fetching blog articles. Talk to Klette."); });

    -# Google Analytics
    = google_analytics_tag
